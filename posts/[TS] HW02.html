<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.283">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="김보람">
<meta name="dcterms.date" content="2023-10-24">

<title>TS - [TS] HW02</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">TS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[TS] HW02</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Time Series</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>김보람 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 24, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<blockquote class="blockquote">
<p>해당 자료는 전북대학교 이영미 교수님 2023고급시계열분석 자료임</p>
</blockquote>
<div id="c68c3339-6b5f-4c74-b262-ad3bd6b482b4" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4ba836ec-f178-4a1a-91bb-c796b72388dc" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/home/coco/Dropbox/Scribbling/posts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="import" class="level1">
<h1>import</h1>
<div id="e6e37111-9e8a-4b27-95af-f5cb751e162f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">############## package</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co">#ses</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest) <span class="co">#dwtest</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TTR) <span class="co">#SMA</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 

Loading required package: zoo


Attaching package: ‘zoo’


The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric



Attaching package: ‘lubridate’


The following objects are masked from ‘package:data.table’:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year


The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union

</code></pre>
</div>
</div>
</section>
<section id="ch03" class="level1">
<h1>CH03</h1>
</section>
<section id="section" class="level1">
<h1>1</h1>
<p>중간재출하지수 자료를 이용하여, 초기 평활값 <span class="math inline">\(S_0^{(1)} = 15\)</span>를 사용하여 <span class="math inline">\(ω = 0.6\)</span>와 <span class="math inline">\(ω = 0.2\)</span>의 각 경우에 1-시차 후 예측값 <span class="math inline">\(Z_{t−1}^{(1)}, t = 2, 3, 99, 100\)</span>을 계산하여라.</p>
<div id="24996d99-8504-4e40-a602-3c26a2f90bdb" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"mindex.txt"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mindex <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1986</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mindex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 9 × 12</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Jan</th>
<th data-quarto-table-cell-role="th" scope="col">Feb</th>
<th data-quarto-table-cell-role="th" scope="col">Mar</th>
<th data-quarto-table-cell-role="th" scope="col">Apr</th>
<th data-quarto-table-cell-role="th" scope="col">May</th>
<th data-quarto-table-cell-role="th" scope="col">Jun</th>
<th data-quarto-table-cell-role="th" scope="col">Jul</th>
<th data-quarto-table-cell-role="th" scope="col">Aug</th>
<th data-quarto-table-cell-role="th" scope="col">Sep</th>
<th data-quarto-table-cell-role="th" scope="col">Oct</th>
<th data-quarto-table-cell-role="th" scope="col">Nov</th>
<th data-quarto-table-cell-role="th" scope="col">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1986</td>
<td>9.3</td>
<td>10.7</td>
<td>13.3</td>
<td>14.1</td>
<td>17.8</td>
<td>18.1</td>
<td>19.4</td>
<td>18.8</td>
<td>19.1</td>
<td>18.4</td>
<td>18.0</td>
<td>17.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1987</td>
<td>19.5</td>
<td>20.1</td>
<td>19.4</td>
<td>15.7</td>
<td>15.6</td>
<td>16.1</td>
<td>14.9</td>
<td>16.0</td>
<td>14.6</td>
<td>18.3</td>
<td>18.2</td>
<td>23.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1988</td>
<td>22.2</td>
<td>22.1</td>
<td>18.8</td>
<td>17.7</td>
<td>13.8</td>
<td>12.7</td>
<td>16.5</td>
<td>15.6</td>
<td>16.3</td>
<td>10.7</td>
<td>10.4</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1989</td>
<td>4.7</td>
<td>4.5</td>
<td>4.0</td>
<td>6.0</td>
<td>6.2</td>
<td>5.7</td>
<td>4.4</td>
<td>4.2</td>
<td>5.0</td>
<td>5.8</td>
<td>6.4</td>
<td>4.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1990</td>
<td>7.9</td>
<td>8.2</td>
<td>11.8</td>
<td>10.0</td>
<td>11.1</td>
<td>11.7</td>
<td>12.4</td>
<td>15.2</td>
<td>14.0</td>
<td>15.2</td>
<td>12.9</td>
<td>18.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1991</td>
<td>14.4</td>
<td>12.7</td>
<td>8.3</td>
<td>11.5</td>
<td>11.9</td>
<td>11.6</td>
<td>10.3</td>
<td>8.5</td>
<td>11.6</td>
<td>12.3</td>
<td>14.5</td>
<td>11.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1992</td>
<td>11.8</td>
<td>12.4</td>
<td>12.7</td>
<td>9.8</td>
<td>10.0</td>
<td>10.2</td>
<td>9.6</td>
<td>6.9</td>
<td>5.3</td>
<td>4.8</td>
<td>4.6</td>
<td>1.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1993</td>
<td>3.8</td>
<td>4.7</td>
<td>7.7</td>
<td>7.0</td>
<td>7.2</td>
<td>7.8</td>
<td>8.6</td>
<td>11.4</td>
<td>10.7</td>
<td>11.8</td>
<td>11.3</td>
<td>16.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1994</td>
<td>13.2</td>
<td>12.0</td>
<td>8.5</td>
<td>11.4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="82b6e467-e666-4f5c-a940-3f1f51207362" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mindex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>추세도 없고 계절성분도 없으니 단순지수평활을 한다.</li>
</ul>
<p>모형 단순지수평활법 사용 <span class="math inline">\(Z_t = \beta_{0,t} + \epsilon_t\)</span></p>
<p>예측 <span class="math inline">\(\hat Z_n(l) = w Z_n + (1-w) \hat Z_{n-1}(l)\)</span></p>
<p><code>-</code></p>
<p>초기 예측값 <span class="math inline">\(Z_1^{(1)}\)</span>은 초기 평활값 <span class="math inline">\(S_0^{(1)}\)</span>를 사용하여 계산</p>
<p><span class="math inline">\(Z_1^{(1)} = S_0^{(1)}=15\)</span></p>
<p><code>-</code> w= 0.2</p>
<div id="dddab5a8-d9a6-4fb0-9cd5-c3f2d73507f4" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(mindex,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">beta =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">l.start =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e062f758-f342-4782-b2b4-78981e0616f0" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing without trend and without seasonal component.

Call:
HoltWinters(x = mindex, alpha = 0.2, beta = FALSE, gamma = FALSE,     l.start = 15.1875)

Smoothing parameters:
 alpha: 0.2
 beta : FALSE
 gamma: FALSE

Coefficients:
      [,1]
a 10.97935</code></pre>
</div>
</div>
<div id="36afa002-2d4c-4368-a5e9-23407861a6bb" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(fit0<span class="sc">$</span>fitted, mindex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 6 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">fit0$fitted.xhat</th>
<th data-quarto-table-cell-role="th" scope="col">fit0$fitted.level</th>
<th data-quarto-table-cell-role="th" scope="col">mindex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jan 1986</td>
<td>NA</td>
<td>NA</td>
<td>9.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Feb 1986</td>
<td>15.00000</td>
<td>15.00000</td>
<td>10.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Mar 1986</td>
<td>14.14000</td>
<td>14.14000</td>
<td>13.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Apr 1986</td>
<td>13.97200</td>
<td>13.97200</td>
<td>14.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">May 1986</td>
<td>13.99760</td>
<td>13.99760</td>
<td>17.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Jun 1986</td>
<td>14.75808</td>
<td>14.75808</td>
<td>18.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>t=2</li>
</ul>
<p><span class="math inline">\(S_2^{(1)} = wZ_2 + (1-w)S_0^{(1)}\)</span></p>
<div id="91b6903c-c518-4621-b663-347cfc3f168d" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="sc">*</span> <span class="fl">10.7</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
14.14
</div>
</div>
<p><span class="math inline">\(S_3^{(1)} = w Z_3 + w (1-w) Z_2 + (1-w)^2 S_0^{(1)}\)</span></p>
<div id="46eb6f33-8172-42c8-b44a-bede50960940" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="sc">*</span> <span class="fl">13.3</span> <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fl">10.7</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
13.972
</div>
</div>
<div id="91ffc0b9-6c38-43dd-8035-ea72727f8a6f" class="cell" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">cbind</span>(fit0<span class="sc">$</span>fitted, mindex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 6 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">fit0$fitted.xhat</th>
<th data-quarto-table-cell-role="th" scope="col">fit0$fitted.level</th>
<th data-quarto-table-cell-role="th" scope="col">mindex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Nov 1993</td>
<td>9.156768</td>
<td>9.156768</td>
<td>11.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Dec 1993</td>
<td>9.585414</td>
<td>9.585414</td>
<td>16.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jan 1994</td>
<td>10.868331</td>
<td>10.868331</td>
<td>13.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Feb 1994</td>
<td>11.334665</td>
<td>11.334665</td>
<td>12.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Mar 1994</td>
<td>11.467732</td>
<td>11.467732</td>
<td>8.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Apr 1994</td>
<td>10.874186</td>
<td>10.874186</td>
<td>11.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math inline">\(S_{99}^{(1)} = w Z_{99} + w (1-w) Z_{98} + \dots + (1-w)^{100} S_0^{(1)}\)</span></p>
<p><code>-</code> 예측 갱신</p>
<p><span class="math display">\[S_n^{(1)} = wZ_n + (1-w)S_{n-1}^{(1)}\]</span></p>
<p><span class="math inline">\(S_{100}^{(1)} = w Z_{100} + (1-w) S_{(99)}^{(1)}\)</span></p>
<div id="b80189a3-b0c8-4bed-9b4e-5f8a4b59b10d" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="sc">*</span> <span class="fl">11.4</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fl">10.874186</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
10.9793488
</div>
</div>
<p><span class="math inline">\(S_{99}^{(1)} = w Z_{99} + (1-w) S_{(98)}^{(1)}\)</span></p>
<div id="04fdb0db-cc65-46f3-b17b-6746719784df" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="sc">*</span> <span class="fl">8.5</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fl">11.467732</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
10.8741856
</div>
</div>
<hr>
<p><code>-</code> w = 0.6</p>
<div id="e0df9027-d714-4ad3-8763-7bc74097655c" class="cell" data-tags="[]" data-execution_count="145">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(mindex,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">beta =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">l.start =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ad27c134-cf3b-424a-a687-4e8f470ae23f" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing without trend and without seasonal component.

Call:
HoltWinters(x = mindex, alpha = 0.6, beta = FALSE, gamma = FALSE,     l.start = 15)

Smoothing parameters:
 alpha: 0.6
 beta : FALSE
 gamma: FALSE

Coefficients:
      [,1]
a 10.90021</code></pre>
</div>
</div>
<div id="bb8ad9d6-2344-4660-b1f5-0ef5e7bdcee7" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(fit1<span class="sc">$</span>fitted, mindex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 6 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">fit1$fitted.xhat</th>
<th data-quarto-table-cell-role="th" scope="col">fit1$fitted.level</th>
<th data-quarto-table-cell-role="th" scope="col">mindex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jan 1986</td>
<td>NA</td>
<td>NA</td>
<td>9.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Feb 1986</td>
<td>15.00000</td>
<td>15.00000</td>
<td>10.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Mar 1986</td>
<td>12.42000</td>
<td>12.42000</td>
<td>13.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Apr 1986</td>
<td>12.94800</td>
<td>12.94800</td>
<td>14.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">May 1986</td>
<td>13.63920</td>
<td>13.63920</td>
<td>17.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Jun 1986</td>
<td>16.13568</td>
<td>16.13568</td>
<td>18.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>t=2</li>
</ul>
<p><span class="math inline">\(S_2^{(1)} = wZ_2 + (1-w)S_0^{(1)}\)</span></p>
<div id="12b5a001-bd7f-4755-bbd4-2bec73aacf1b" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span> <span class="sc">*</span> <span class="fl">10.7</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
12.42
</div>
</div>
<p><span class="math inline">\(S_3^{(1)} = w Z_3 + w (1-w) Z_2 + (1-w)^2 S_0^{(1)}\)</span></p>
<div id="a5cb2325-be2f-4f5e-97ac-55143b38c67e" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span> <span class="sc">*</span> <span class="fl">13.3</span> <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fl">0.4</span><span class="sc">*</span><span class="fl">10.7</span> <span class="sc">+</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fl">0.4</span><span class="sc">*</span><span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
12.948
</div>
</div>
<div id="e6dc133a-dc3d-461f-ad71-1b9baed9c930" class="cell" data-tags="[]" data-execution_count="149">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">cbind</span>(fit1<span class="sc">$</span>fitted, mindex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 6 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">fit1$fitted.xhat</th>
<th data-quarto-table-cell-role="th" scope="col">fit1$fitted.level</th>
<th data-quarto-table-cell-role="th" scope="col">mindex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Nov 1993</td>
<td>11.26423</td>
<td>11.26423</td>
<td>11.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Dec 1993</td>
<td>11.28569</td>
<td>11.28569</td>
<td>16.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jan 1994</td>
<td>14.11428</td>
<td>14.11428</td>
<td>13.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Feb 1994</td>
<td>13.56571</td>
<td>13.56571</td>
<td>12.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Mar 1994</td>
<td>12.62628</td>
<td>12.62628</td>
<td>8.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Apr 1994</td>
<td>10.15051</td>
<td>10.15051</td>
<td>11.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math inline">\(S_{99}^{(1)} = w Z_{99} + w (1-w) Z_{98} + \dots + (1-w)^{100} S_0^{(1)}\)</span></p>
<p><code>-</code> 예측 갱신</p>
<p><span class="math display">\[S_n^{(1)} = wZ_n + (1-w)S_{n-1}^{(1)}\]</span></p>
<p><span class="math inline">\(S_{100}^{(1)} = w Z_{100} + (1-w) S_{(99)}^{(1)}\)</span></p>
<div id="890d5ac3-3645-48f2-8ca2-13b6ef3ae7c0" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span><span class="sc">*</span><span class="fl">11.4+0.4</span><span class="sc">*</span><span class="fl">10.15051</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
10.900204
</div>
</div>
<p><span class="math inline">\(S_{99}^{(1)} = w Z_{99} + (1-w) S_{(98)}^{(1)}\)</span></p>
<div id="0668ceac-f67d-46f9-81bb-2e7af9b44e69" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span><span class="sc">*</span><span class="fl">8.5+0.4</span><span class="sc">*</span><span class="fl">12.62628</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
10.150512
</div>
</div>
<hr>
</section>
<section id="예측오차분석을-안했다." class="level1">
<h1>2 (예측오차분석을 안했다.;;)</h1>
<p>(R 실습) 다음의 각 자료에 대해 적절한 평활법을 적용한 후 , 예측오차 분석을 하여 적용한 평활법이 적절했는지 논하여라. 그리고 (2)번의 경우 첫번째 과제 5,6번에서 적합한 모형과 1-시차 후 예측 오차의 제곱합 (SSE) 기준하에서 예측력을 비교하여라.</p>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">(1)</h2>
<p>‘female.txt’ : 월별 전문기술행정직에 종사하는 여성근로자 수 (단위:명)</p>
<div id="d86553e1-fe73-4538-b74c-9cd1794ec963" class="cell" data-execution_count="347">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"female.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dce9ea9b-687c-4c70-899c-cd518f486134" class="cell" data-execution_count="348">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fema <span class="ot">&lt;-</span> <span class="fu">ts</span>(female, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fab5b27e-fded-4717-9e80-b4b0d0c770d2" class="cell" data-execution_count="349">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>시도표를 확인해보니 추세성분과 불규칙성분으로 이루어져 있다. —&gt; 이중지수평활을 사용한다.</li>
</ul>
<p><code>-</code> 1모수 이중지수 평활</p>
<div id="b1987c4f-75d2-417f-ac0d-c35c72757017" class="cell" data-execution_count="374">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="fl">0.1</span>), <span class="fu">seq</span>(<span class="fl">0.81</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dfd70d89-9d7a-44d0-b6d6-04a5adbd8011" class="cell" data-execution_count="382">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">alpha =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(w)), <span class="at">beta =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(w)), <span class="at">sse =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(w)))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(w)) {</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> w[i]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> w[i]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(fema, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, <span class="at">gamma =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  sse <span class="ot">&lt;-</span> fit<span class="sc">$</span>SSE</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  df[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(alpha, beta, sse)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0c554474-4f10-49e1-9a25-27f3a541b263" class="cell" data-execution_count="383">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 27 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">alpha</th>
<th data-quarto-table-cell-role="th" scope="col">beta</th>
<th data-quarto-table-cell-role="th" scope="col">sse</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.10</td>
<td>0.10</td>
<td>47737.16</td>
</tr>
<tr class="even">
<td>0.20</td>
<td>0.20</td>
<td>39413.25</td>
</tr>
<tr class="odd">
<td>0.30</td>
<td>0.30</td>
<td>32655.02</td>
</tr>
<tr class="even">
<td>0.40</td>
<td>0.40</td>
<td>28136.56</td>
</tr>
<tr class="odd">
<td>0.50</td>
<td>0.50</td>
<td>23964.31</td>
</tr>
<tr class="even">
<td>0.60</td>
<td>0.60</td>
<td>21390.42</td>
</tr>
<tr class="odd">
<td>0.70</td>
<td>0.70</td>
<td>20179.01</td>
</tr>
<tr class="even">
<td>0.80</td>
<td>0.80</td>
<td>19991.82</td>
</tr>
<tr class="odd">
<td>0.81</td>
<td>0.81</td>
<td>20034.76</td>
</tr>
<tr class="even">
<td>0.82</td>
<td>0.82</td>
<td>20090.85</td>
</tr>
<tr class="odd">
<td>0.83</td>
<td>0.83</td>
<td>20160.82</td>
</tr>
<tr class="even">
<td>0.84</td>
<td>0.84</td>
<td>20245.43</td>
</tr>
<tr class="odd">
<td>0.85</td>
<td>0.85</td>
<td>20345.55</td>
</tr>
<tr class="even">
<td>0.86</td>
<td>0.86</td>
<td>20462.10</td>
</tr>
<tr class="odd">
<td>0.87</td>
<td>0.87</td>
<td>20596.12</td>
</tr>
<tr class="even">
<td>0.88</td>
<td>0.88</td>
<td>20748.74</td>
</tr>
<tr class="odd">
<td>0.89</td>
<td>0.89</td>
<td>20921.19</td>
</tr>
<tr class="even">
<td>0.90</td>
<td>0.90</td>
<td>21114.85</td>
</tr>
<tr class="odd">
<td>0.91</td>
<td>0.91</td>
<td>21331.22</td>
</tr>
<tr class="even">
<td>0.92</td>
<td>0.92</td>
<td>21571.99</td>
</tr>
<tr class="odd">
<td>0.93</td>
<td>0.93</td>
<td>21839.02</td>
</tr>
<tr class="even">
<td>0.94</td>
<td>0.94</td>
<td>22134.40</td>
</tr>
<tr class="odd">
<td>0.95</td>
<td>0.95</td>
<td>22460.49</td>
</tr>
<tr class="even">
<td>0.96</td>
<td>0.96</td>
<td>22819.94</td>
</tr>
<tr class="odd">
<td>0.97</td>
<td>0.97</td>
<td>23215.75</td>
</tr>
<tr class="even">
<td>0.98</td>
<td>0.98</td>
<td>23651.34</td>
</tr>
<tr class="odd">
<td>0.99</td>
<td>0.99</td>
<td>24130.60</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>1모수 이중지수일때는 <span class="math inline">\(\alpha=\beta=0.8\)</span>일 때, SSE값이 19991.82 값을 가진다.</p>
<p><code>-</code> 이중지수평활 추정</p>
<div id="5e23624d-4ad9-4d4a-94e8-51ec87689a3b" class="cell" data-execution_count="384">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fit_fema <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(fema, <span class="at">gamma=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ce9f8c48-22a2-4eae-99fe-feb1d10e0a9b" class="cell" data-execution_count="385">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fit_fema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing with trend and without seasonal component.

Call:
HoltWinters(x = fema, gamma = FALSE)

Smoothing parameters:
 alpha: 1
 beta : 0.01666631
 gamma: FALSE

Coefficients:
        [,1]
a 667.000000
b   5.145043</code></pre>
</div>
</div>
<div id="9aa59607-552b-4f6f-9eb7-f35bd8998755" class="cell" data-execution_count="386">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit_fema, <span class="at">n.ahead=</span><span class="dv">12</span>, <span class="at">prediction.interval =</span> T, <span class="at">level=</span><span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 12 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">fit</th>
<th data-quarto-table-cell-role="th" scope="col">upr</th>
<th data-quarto-table-cell-role="th" scope="col">lwr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jan 1990</td>
<td>672.1450</td>
<td>694.8066</td>
<td>649.4835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Feb 1990</td>
<td>677.2901</td>
<td>709.6065</td>
<td>644.9736</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Mar 1990</td>
<td>682.4351</td>
<td>722.3438</td>
<td>642.5264</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Apr 1990</td>
<td>687.5802</td>
<td>734.0440</td>
<td>641.1163</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">May 1990</td>
<td>692.7252</td>
<td>745.1007</td>
<td>640.3498</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Jun 1990</td>
<td>697.8703</td>
<td>755.7139</td>
<td>640.0266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jul 1990</td>
<td>703.0153</td>
<td>766.0016</td>
<td>640.0290</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Aug 1990</td>
<td>708.1603</td>
<td>776.0399</td>
<td>640.2807</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Sep 1990</td>
<td>713.3054</td>
<td>785.8813</td>
<td>640.7295</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Oct 1990</td>
<td>718.4504</td>
<td>795.5635</td>
<td>641.3374</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Nov 1990</td>
<td>723.5955</td>
<td>805.1148</td>
<td>642.0761</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Dec 1990</td>
<td>728.7405</td>
<td>814.5572</td>
<td>642.9238</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="a2674817-4516-4817-bee9-3b5bbebacc6e" class="cell" data-execution_count="387">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_fema<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
14153.8104898823
</div>
</div>
<hr>
<p><code>-</code> 단순지수평활법 적합</p>
<div id="55879a1d-15c3-4955-bc5a-c1a9dcb3ef20" class="cell" data-execution_count="395">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fit_fema2 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(fema, <span class="at">beta=</span><span class="cn">FALSE</span>, <span class="at">gamma=</span><span class="cn">FALSE</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fit_fema2</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>fit_fema2<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing without trend and without seasonal component.

Call:
HoltWinters(x = fema, beta = FALSE, gamma = FALSE)

Smoothing parameters:
 alpha: 0.9999225
 beta : FALSE
 gamma: FALSE

Coefficients:
      [,1]
a 666.9998</code></pre>
</div>
<div class="cell-output cell-output-display">
15579.4993710227
</div>
</div>
<hr>
<p><code>-</code> 계절지수평활법 적합</p>
<div id="828acf52-1aba-4db0-a539-bdff6c9321da" class="cell" data-execution_count="397">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fit_fema3 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(fema, <span class="at">seasonal=</span><span class="st">"additive"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fit_fema3</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>fit_fema3<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing with trend and additive seasonal component.

Call:
HoltWinters(x = fema, seasonal = "additive")

Smoothing parameters:
 alpha: 0.5689925
 beta : 0.01533418
 gamma: 1

Coefficients:
          [,1]
a   677.319852
b     4.462732
s1  -10.805353
s2  -10.907550
s3   13.687188
s4   21.650246
s5   29.187883
s6   39.477663
s7   33.205948
s8   19.062994
s9    5.235871
s10  -3.290505
s11 -11.437139
s12 -10.319852</code></pre>
</div>
<div class="cell-output cell-output-display">
25835.5416290603
</div>
</div>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">(2)</h2>
<p>‘export.txt’ ; 월별수출액(단위:억$)</p>
<div id="0a1020e3-755b-4e37-84f0-d54face9d9b2" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>export <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"export.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="41b0de82-8bb0-469a-a9a6-0345731ba6e4" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>expo <span class="ot">&lt;-</span> <span class="fu">ts</span>(export, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4bfcf5fb-4bbf-4b97-b149-878e33f93132" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(expo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-46-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>추세성분, 계절성분(주기12), 불규칙성분으로 구성되어 있다. –&gt; 계절지수 평활을 이용하자!</li>
</ul>
<p><code>-</code> 가법모형</p>
<div id="0680c303-c2d8-479d-ad87-d5afa534e63d" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit_expo_a <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(expo, <span class="at">seasonal=</span><span class="st">"additive"</span>) <span class="co">#default는 additive</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fit_expo_a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing with trend and additive seasonal component.

Call:
HoltWinters(x = expo, seasonal = "additive")

Smoothing parameters:
 alpha: 0.3304767
 beta : 0.04369053
 gamma: 0.6102758

Coefficients:
           [,1]
a    66.9300146
b     0.3670945
s1   -0.9590061
s2   -2.3460160
s3   -1.4388022
s4    4.0020957
s5   -2.8546787
s6   -3.1036803
s7    0.4486017
s8    3.3118493
s9    1.6302355
s10   8.0731659
s11 -11.5480012
s12  -8.8892298</code></pre>
</div>
</div>
<div id="1a129a55-a5de-4cb5-a861-648caf03e10d" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_expo_m <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(expo, <span class="at">seasonal=</span><span class="st">"multiplicative"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>fit_expo_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing with trend and multiplicative seasonal component.

Call:
HoltWinters(x = expo, seasonal = "multiplicative")

Smoothing parameters:
 alpha: 0.4285887
 beta : 0.02606259
 gamma: 0.4083356

Coefficients:
          [,1]
a   68.7136998
b    0.5141142
s1   0.9879869
s2   0.9620299
s3   0.9996946
s4   1.0834386
s5   0.9897148
s6   0.9744549
s7   1.0319339
s8   1.0425559
s9   1.0357445
s10  1.1286956
s11  0.8073858
s12  0.8400441</code></pre>
</div>
</div>
<div id="3033247e-8b1d-48c4-893d-ac555624c3e5" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fit_expo_a<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
1135.42182593918
</div>
</div>
<div id="c9cc9e55-8494-4d8b-9cf6-4ab76c9e6025" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fit_expo_m<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
1048.2628205778
</div>
</div>
<p>승법 모형의 SSE가 더 작으니 이 모형을 선택하자.</p>
<p><code>-</code> 이중지수</p>
<div id="f32b76ac-2acc-46fa-821c-628db38dc2a3" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fit_expo2<span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(expo, <span class="at">gamma=</span><span class="cn">FALSE</span> )</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>fit_expo2<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
3338.93312288425
</div>
</div>
<div id="a3c3497e-0cc0-4763-90f3-0253ca2ad140" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fit_expo3<span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(expo, <span class="at">beta=</span><span class="cn">FALSE</span>, <span class="at">gamma=</span><span class="cn">FALSE</span> )</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fit_expo3<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
3311.57259808501
</div>
</div>
<section id="hw1_6" class="level3">
<h3 class="anchored" data-anchor-id="hw1_6">hw1_6</h3>
<div id="e5fd2e9b-b830-4819-b69f-96f5e0192371" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"export.txt"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(z)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
86
</div>
</div>
<div id="5c8e6e07-da1b-4b8b-bd84-6bd1470130cb" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>z_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cycle</span>(z_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 8 × 12</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Jan</th>
<th data-quarto-table-cell-role="th" scope="col">Feb</th>
<th data-quarto-table-cell-role="th" scope="col">Mar</th>
<th data-quarto-table-cell-role="th" scope="col">Apr</th>
<th data-quarto-table-cell-role="th" scope="col">May</th>
<th data-quarto-table-cell-role="th" scope="col">Jun</th>
<th data-quarto-table-cell-role="th" scope="col">Jul</th>
<th data-quarto-table-cell-role="th" scope="col">Aug</th>
<th data-quarto-table-cell-role="th" scope="col">Sep</th>
<th data-quarto-table-cell-role="th" scope="col">Oct</th>
<th data-quarto-table-cell-role="th" scope="col">Nov</th>
<th data-quarto-table-cell-role="th" scope="col">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">5</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">6</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">7</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">8</td>
<td>1</td>
<td>2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="886b57f3-53d9-4adc-8a20-1dcfeefdbe76" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>seasonal_I <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cycle</span>(z_ts))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(z<span class="sc">~</span>t<span class="sc">+</span>seasonal_I)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0715df8e-1465-4a49-b278-54a64ee837eb" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = z ~ t + seasonal_I)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.8562  -2.2938   0.1567   2.6730   9.3951 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  21.98000    1.73500  12.669  &lt; 2e-16 ***
t             0.43721    0.01893  23.097  &lt; 2e-16 ***
seasonal_I2   1.71779    2.16697   0.793 0.430512    
seasonal_I3   9.21741    2.24422   4.107 0.000103 ***
seasonal_I4   7.37163    2.24366   3.286 0.001566 ** 
seasonal_I5   9.30299    2.24326   4.147 8.98e-05 ***
seasonal_I6  12.96578    2.24302   5.780 1.72e-07 ***
seasonal_I7   9.16286    2.24294   4.085 0.000112 ***
seasonal_I8   7.73422    2.24302   3.448 0.000941 ***
seasonal_I9  11.07272    2.24326   4.936 4.88e-06 ***
seasonal_I10 10.68409    2.24366   4.762 9.47e-06 ***
seasonal_I11 12.37545    2.24422   5.514 5.03e-07 ***
seasonal_I12 18.57967    2.24494   8.276 4.26e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.334 on 73 degrees of freedom
Multiple R-squared:  0.9011,    Adjusted R-squared:  0.8848 
F-statistic:  55.4 on 12 and 73 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="b27a4933-1a3a-4c44-b692-d476d269556d" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(m2<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
1371.05731181319
</div>
</div>
<blockquote class="blockquote">
<p>과제 1에서 적합한 선형모델보다 평활법(계절지수, 가법_승법_)으로 적합한 모델의 SSE가 너 낮게 나왔다.</p>
</blockquote>
</section>
</section>
</section>
<section id="section-3" class="level1">
<h1>3</h1>
<p>(R 실습) ’data1.csv’는 모의 실험에 의해 생성된 시계열자료(t:시간, z:시계열자료)이다.다음 물음 에 답하여라.</p>
<div id="1237c916-9b9d-4fd6-8361-f54e76c54323" class="cell" data-execution_count="411">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data1.csv"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> data1<span class="sc">$</span>t</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data1<span class="sc">$</span>z</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(data1<span class="sc">$</span>t)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>data1_ <span class="ot">&lt;-</span> <span class="fu">ts</span>(y, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>data1_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 9 × 12</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Jan</th>
<th data-quarto-table-cell-role="th" scope="col">Feb</th>
<th data-quarto-table-cell-role="th" scope="col">Mar</th>
<th data-quarto-table-cell-role="th" scope="col">Apr</th>
<th data-quarto-table-cell-role="th" scope="col">May</th>
<th data-quarto-table-cell-role="th" scope="col">Jun</th>
<th data-quarto-table-cell-role="th" scope="col">Jul</th>
<th data-quarto-table-cell-role="th" scope="col">Aug</th>
<th data-quarto-table-cell-role="th" scope="col">Sep</th>
<th data-quarto-table-cell-role="th" scope="col">Oct</th>
<th data-quarto-table-cell-role="th" scope="col">Nov</th>
<th data-quarto-table-cell-role="th" scope="col">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1981</td>
<td>-1.5346871</td>
<td>2.6850469</td>
<td>-0.4288189</td>
<td>1.3724199</td>
<td>-0.9800884</td>
<td>2.4156505</td>
<td>0.1460579</td>
<td>1.9565546</td>
<td>0.3314012</td>
<td>0.1031952</td>
<td>4.5465702</td>
<td>3.3733991</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1982</td>
<td>2.1320092</td>
<td>1.4610979</td>
<td>3.5995999</td>
<td>2.6229617</td>
<td>3.3260846</td>
<td>2.6279068</td>
<td>2.4061911</td>
<td>4.9681833</td>
<td>2.1537724</td>
<td>3.2376604</td>
<td>2.0848844</td>
<td>4.4146009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1983</td>
<td>5.5427871</td>
<td>3.5727733</td>
<td>3.6793795</td>
<td>1.0197987</td>
<td>4.1619256</td>
<td>3.9038326</td>
<td>2.1724542</td>
<td>4.9360919</td>
<td>4.8127781</td>
<td>4.6404884</td>
<td>4.4090738</td>
<td>3.3529045</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1984</td>
<td>4.0967541</td>
<td>3.4881527</td>
<td>4.4249974</td>
<td>4.3210561</td>
<td>7.7103219</td>
<td>5.0907609</td>
<td>4.5999605</td>
<td>4.9773808</td>
<td>7.6107690</td>
<td>4.9986647</td>
<td>7.1678722</td>
<td>7.1542270</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1985</td>
<td>6.6329637</td>
<td>2.8462231</td>
<td>9.3646617</td>
<td>4.4855729</td>
<td>5.2444451</td>
<td>5.8160173</td>
<td>5.0466196</td>
<td>9.5742821</td>
<td>9.0751720</td>
<td>6.6775546</td>
<td>6.7345322</td>
<td>5.7569890</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1986</td>
<td>8.3008035</td>
<td>7.5701959</td>
<td>6.5050066</td>
<td>6.0962461</td>
<td>7.4245090</td>
<td>4.4973441</td>
<td>6.5920516</td>
<td>6.9026479</td>
<td>4.6123368</td>
<td>7.7952478</td>
<td>8.4416974</td>
<td>5.6684225</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1987</td>
<td>8.5028659</td>
<td>8.8312543</td>
<td>6.9776594</td>
<td>7.0775957</td>
<td>8.4638087</td>
<td>10.7761422</td>
<td>9.4661818</td>
<td>8.7774843</td>
<td>8.9804188</td>
<td>7.1654550</td>
<td>9.5367387</td>
<td>8.8641697</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1988</td>
<td>8.9645710</td>
<td>7.5418683</td>
<td>9.0336999</td>
<td>10.8611356</td>
<td>8.7190544</td>
<td>14.1133979</td>
<td>9.5868440</td>
<td>11.4598053</td>
<td>8.2142746</td>
<td>10.9960972</td>
<td>11.3776375</td>
<td>11.4480245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1989</td>
<td>12.5356509</td>
<td>8.8132146</td>
<td>9.1437447</td>
<td>10.2114895</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="3ae4d066-ea25-4acc-9326-c1a1fe6caca0" class="cell" data-execution_count="410">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data1_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-60-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>추세와 계절성분, 불규칙성이 있어보인다.</li>
</ul>
<section id="교수님은-계절성분이-없고-추세만-있어-모형을-적합하였음" class="level2">
<h2 class="anchored" data-anchor-id="교수님은-계절성분이-없고-추세만-있어-모형을-적합하였음">(1) 교수님은 계절성분이 없고 추세만 있어 모형을 적합하였음</h2>
<p>적절한 추세 모형을 적합시킨 후 잔차분석을 하여라.</p>
<p>계절추세모형 <span class="math display">\[Z_t = \beta_0 + \beta_1 + \sum_{i=1}^l 2\delta_i \times I_{tl} + \epsilon_t$, 단 $\delta_1=0\]</span></p>
<div id="8babccf9-c9a7-4b1d-adf6-d354ed3d3f64" class="cell" data-execution_count="412">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cycle</span>(data1_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 9 × 12</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Jan</th>
<th data-quarto-table-cell-role="th" scope="col">Feb</th>
<th data-quarto-table-cell-role="th" scope="col">Mar</th>
<th data-quarto-table-cell-role="th" scope="col">Apr</th>
<th data-quarto-table-cell-role="th" scope="col">May</th>
<th data-quarto-table-cell-role="th" scope="col">Jun</th>
<th data-quarto-table-cell-role="th" scope="col">Jul</th>
<th data-quarto-table-cell-role="th" scope="col">Aug</th>
<th data-quarto-table-cell-role="th" scope="col">Sep</th>
<th data-quarto-table-cell-role="th" scope="col">Oct</th>
<th data-quarto-table-cell-role="th" scope="col">Nov</th>
<th data-quarto-table-cell-role="th" scope="col">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1981</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1982</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1983</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1984</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1985</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1986</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1987</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">1988</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1989</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="612f7dec-0ad6-40c4-8a22-58b9d4df1fda" class="cell" data-execution_count="420">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>seasonal_I <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cycle</span>(data1_))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#t &lt;- 1:n</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span> t <span class="sc">+</span>seasonal_I)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="805d430f-31b4-49b4-90ad-27361911e50e" class="cell" data-execution_count="421">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = y ~ 0 + t + seasonal_I)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4526 -0.8739 -0.1227  0.8747  3.7703 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
t             0.09971    0.00507  19.667  &lt; 2e-16 ***
seasonal_I1   1.24446    0.54646   2.277  0.02522 *  
seasonal_I2   0.21542    0.54878   0.393  0.69562    
seasonal_I3   0.72572    0.55115   1.317  0.19138    
seasonal_I4   0.15582    0.55354   0.282  0.77899    
seasonal_I5   0.82223    0.56859   1.446  0.15175    
seasonal_I6   1.36889    0.57074   2.398  0.01860 *  
seasonal_I7   0.11609    0.57292   0.203  0.83990    
seasonal_I8   1.70838    0.57513   2.970  0.00384 ** 
seasonal_I9   0.63848    0.57739   1.106  0.27185    
seasonal_I10  0.51670    0.57967   0.891  0.37519    
seasonal_I11  1.50257    0.58200   2.582  0.01150 *  
seasonal_I12  0.86957    0.58436   1.488  0.14035    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.46 on 87 degrees of freedom
Multiple R-squared:  0.9584,    Adjusted R-squared:  0.9522 
F-statistic: 154.2 on 13 and 87 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>적합모형</li>
</ul>
<p><span class="math inline">\(\hat Z_t = 0.09971 t +1.24446 I_{t1} \dots +0.86957 I_{t12}\)</span></p>
<p><code>-</code> 잔차검정</p>
<div id="fcc36a0e-01b2-4fa5-8b31-f9767ea3b31a" class="cell" data-execution_count="422">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>resid_m <span class="ot">&lt;-</span> <span class="fu">resid</span>(m2)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid_m, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-64-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="0603748a-f258-4667-a408-83603e9e0de4" class="cell" data-execution_count="316">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(resid_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  resid_m
t = 4.1891e-18, df = 99, p-value = 1
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.2716042  0.2716042
sample estimates:
   mean of x 
5.734074e-19 </code></pre>
</div>
</div>
<div id="acb24465-b52e-4ae2-93a4-7885490396ea" class="cell" data-execution_count="425">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    studentized Breusch-Pagan test

data:  m2
BP = 11.4, df = 12, p-value = 0.495</code></pre>
</div>
</div>
<div id="3e5c906d-0d39-4283-a82b-420b75e31c7e" class="cell" data-execution_count="317">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(resid_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="6f1bbb97-e48d-4ed0-8507-71f3fff0e98a" class="cell" data-execution_count="426">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(resid_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Shapiro-Wilk normality test

data:  resid_m
W = 0.99218, p-value = 0.8338</code></pre>
</div>
</div>
<div id="288f84b1-6083-42fd-9182-4b76f4335acb" class="cell" data-execution_count="428">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(m2, <span class="at">alternative =</span> <span class="st">"two.sided"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  m2
DW = 2.1153, p-value = 0.5919
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">(2)</h2>
<p>(1)에서 적합한 추세모형에서 1∼ 10 시차 후의 예측값을 구하여라.</p>
<div id="bd59167d-0739-4ed5-b00d-cef9333426af" class="cell" data-execution_count="429">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>new_dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">t =</span> n <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a> <span class="at">seasonal_I =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>new_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 10 × 2</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">t</th>
<th data-quarto-table-cell-role="th" scope="col">seasonal_I</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;int&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>5</td>
</tr>
<tr class="even">
<td>102</td>
<td>6</td>
</tr>
<tr class="odd">
<td>103</td>
<td>7</td>
</tr>
<tr class="even">
<td>104</td>
<td>8</td>
</tr>
<tr class="odd">
<td>105</td>
<td>9</td>
</tr>
<tr class="even">
<td>106</td>
<td>10</td>
</tr>
<tr class="odd">
<td>107</td>
<td>11</td>
</tr>
<tr class="even">
<td>108</td>
<td>12</td>
</tr>
<tr class="odd">
<td>109</td>
<td>1</td>
</tr>
<tr class="even">
<td>110</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="b8093e99-7fb0-48ec-9065-95486ef676e3" class="cell" data-execution_count="454">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m2, new_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>1</dt><dd>10.8932810379944</dd><dt>2</dt><dd>11.539654967107</dd><dt>3</dt><dd>10.386568516118</dd><dt>4</dt><dd>12.0785772090589</dd><dt>5</dt><dd>11.108388789967</dd><dt>6</dt><dd>11.0863188261925</dd><dt>7</dt><dd>12.1718992420353</dd><dt>8</dt><dd>11.6386155761184</dd><dt>9</dt><dd>12.113216954006</dd><dt>10</dt><dd>11.1838957059557</dd></dl>
</div>
</div>
<div id="7eb2e608-737e-40c8-94da-c880f78d0cbf" class="cell" data-execution_count="455">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2, new_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">(3)</h2>
<p>적절한 평활법을 적용한 후 잔차분석을 하여라.</p>
<ul>
<li>시도표에서 등분산으로 보이니 가법모형 적용</li>
</ul>
<div id="5a9f8d3a-d615-4fc0-afc9-f3b7f4e224c9" class="cell" data-execution_count="439">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>fit_data_a <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(data1_, <span class="at">seasonal=</span><span class="st">"additive"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fit_data_a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing with trend and additive seasonal component.

Call:
HoltWinters(x = data1_, seasonal = "additive")

Smoothing parameters:
 alpha: 0.1075626
 beta : 0.03407311
 gamma: 0.2315828

Coefficients:
           [,1]
a   11.19913122
b    0.10780161
s1  -0.07016081
s2   0.66130312
s3  -0.85496062
s4   0.47657925
s5  -0.88090464
s6  -0.76891779
s7   0.57746908
s8  -0.22134249
s9   0.45302226
s10 -1.33334803
s11 -0.44879394
s12 -0.72310382</code></pre>
</div>
</div>
<div id="de04e839-efbd-4dc9-b564-ecf18a415c56" class="cell" data-execution_count="441">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(fit_data_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'alpha'</li><li>'beta'</li><li>'call'</li><li>'coefficients'</li><li>'fitted'</li><li>'gamma'</li><li>'seasonal'</li><li>'SSE'</li><li>'x'</li></ol>
</div>
</div>
<div id="238a1275-3f44-44d8-96cc-7ac747379acc" class="cell" data-execution_count="442">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fit_data_a<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
241.40429231834
</div>
</div>
<div id="da33649b-2bdf-46f0-b473-456d74706f14" class="cell" data-execution_count="443">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>f_resid_m <span class="ot">&lt;-</span> <span class="fu">resid</span>(fit_data_a)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f_resid_m, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-77-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="56fe1fb6-6d42-4be3-a59e-42d7fb13dd9b" class="cell" data-execution_count="434">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(f_resid_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  f_resid_m
t = -0.97545, df = 87, p-value = 0.332
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.5232992  0.1787545
sample estimates:
 mean of x 
-0.1722723 </code></pre>
</div>
</div>
<div id="394621b4-3fa2-4c34-a6d1-054e044950e0" class="cell" data-execution_count="435">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(f_resid_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-80-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="8201052a-182e-43f1-8e00-7937f021fa1d" class="cell" data-execution_count="437">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(f_resid_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Shapiro-Wilk normality test

data:  f_resid_m
W = 0.99387, p-value = 0.9586</code></pre>
</div>
</div>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">(4)</h2>
<p>(3)의 결과를 이용하여 1∼10시차 후의 예측값을 구하여라.</p>
<div id="9a020d32-0b9a-4399-a947-ffe3c52cf609" class="cell" data-execution_count="483">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit_data_a, <span class="at">n.ahead=</span><span class="dv">10</span>, <span class="at">prediction.interval =</span> T, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 10 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">fit</th>
<th data-quarto-table-cell-role="th" scope="col">upr</th>
<th data-quarto-table-cell-role="th" scope="col">lwr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">May 1989</td>
<td>11.23677</td>
<td>14.48390</td>
<td>7.989648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Jun 1989</td>
<td>12.07604</td>
<td>15.34319</td>
<td>8.808889</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jul 1989</td>
<td>10.66758</td>
<td>13.95596</td>
<td>7.379195</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Aug 1989</td>
<td>12.10692</td>
<td>15.41775</td>
<td>8.796079</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Sep 1989</td>
<td>10.85723</td>
<td>14.19177</td>
<td>7.522695</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Oct 1989</td>
<td>11.07702</td>
<td>14.43652</td>
<td>7.717522</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Nov 1989</td>
<td>12.53121</td>
<td>15.91695</td>
<td>9.145475</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Dec 1989</td>
<td>11.84020</td>
<td>15.25346</td>
<td>8.426943</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">Jan 1990</td>
<td>12.62237</td>
<td>16.06444</td>
<td>9.180291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">Feb 1990</td>
<td>10.94380</td>
<td>14.41600</td>
<td>7.471600</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="7f41ae57-9156-4cd8-82e0-2281f476adc7" class="cell" data-execution_count="477">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>prediction_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_data_a, <span class="at">n.ahead=</span><span class="dv">10</span>, <span class="at">prediction.interval =</span> T, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5d1b5703-476f-4ea7-a41d-ab3f2765ccea" class="cell" data-execution_count="486">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> prediction_result[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">(5)</h2>
<p>실제 1, 2, . . . , 10 시차 후의 관측값이 ’data1 new.csv’일 때, (2), (4)의 결과를 이용하여 어느 모형이 더 적합했는지에 대해 비교하여라.</p>
<div id="5747f7e3-326f-49d9-828d-dfc138ded911" class="cell" data-execution_count="448">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>data1new <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data1_new.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b59ac2ad-ee8a-4743-9ac9-8bbefcad3422" class="cell" data-execution_count="459">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((data1new<span class="sc">$</span>z <span class="sc">-</span> a)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
38.302781319433
</div>
</div>
<div id="a93797d1-4f22-4f95-85e0-7127b1a64ddb" class="cell" data-execution_count="487">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((data1new<span class="sc">$</span>z <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
35.5553155409459
</div>
</div>
<p>(4)의 모형이 더 적합했다.</p>
</section>
</section>
<section id="ch04" class="level1">
<h1>CH04</h1>
</section>
<section id="section-8" class="level1">
<h1>4</h1>
<p>(R 실습) ’export.txt’자료에 대하여 각가 다음 물음에 답하여라.</p>
<div id="0c89a174-d847-41fc-9692-756058da28e3" class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"export.txt"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>export <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(export, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"TS plot for export data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-94-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">(1)</h2>
<p>추세분석을 이용한 분해법에 의한 각 성분의 시계열 그림을 그려라.</p>
<p><code>-</code> 추세성분 추정: <span class="math inline">\(Z_t = \beta_0 + \beta_1t + \epsilon_t\)</span> 적합</p>
<div id="77a40d20-69b2-49dd-8649-3a567d2485fa" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(export  <span class="sc">~</span> t)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = export ~ t)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1230  -4.0245  -0.6699   4.1819  17.3619 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.62075    1.37454   22.28   &lt;2e-16 ***
t            0.44520    0.02744   16.22   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.318 on 84 degrees of freedom
Multiple R-squared:  0.758, Adjusted R-squared:  0.7552 
F-statistic: 263.2 on 1 and 84 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><span class="math inline">\(\hat T_t = 30.621 + 0.445 t\)</span></p>
<div id="89bf2535-a2f9-45b3-ad99-d130cb08f567" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>hat_Tt <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit0)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(export, hat_Tt,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"export"</span>, <span class="at">xlab=</span><span class="st">"time"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"시계열과 분해법에 의한 추세성분"</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">"z"</span>, <span class="st">"추세성분"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-96-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 계절성분</p>
<div id="8af35763-3757-40eb-91ee-811e1130b0df" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 원시계열에서 추세성분 조정</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>adjtrend_ <span class="ot">=</span> export<span class="sc">-</span>hat_Tt</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(adjtrend_, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-97-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="c6fae74c-0e8c-4963-8959-912928149ff2" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">cycle</span>(adjtrend_))</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(adjtrend_ <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span>y)  <span class="co"># 제약조건 beta0=0</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = adjtrend_ ~ 0 + y)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.5684  -2.4909   0.0174   2.5296   9.4910 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
y1   -8.9845     1.5237  -5.897 1.03e-07 ***
y2   -7.2747     1.5237  -4.774 8.87e-06 ***
y3    0.2649     1.6289   0.163   0.8713    
y4   -1.5889     1.6289  -0.975   0.3325    
y5    0.3345     1.6289   0.205   0.8379    
y6    3.9893     1.6289   2.449   0.0167 *  
y7    0.1784     1.6289   0.110   0.9131    
y8   -1.2583     1.6289  -0.772   0.4423    
y9    2.0722     1.6289   1.272   0.2073    
y10   1.6756     1.6289   1.029   0.3070    
y11   3.3590     1.6289   2.062   0.0427 *  
y12   9.5552     1.6289   5.866 1.17e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.31 on 74 degrees of freedom
Multiple R-squared:  0.5901,    Adjusted R-squared:  0.5236 
F-statistic: 8.878 on 12 and 74 DF,  p-value: 3.121e-10</code></pre>
</div>
</div>
<p><span class="math inline">\(\hat S_t = -8.9845 I_1 + \dots +9.5552I_{12}\)</span></p>
<div id="6528ab5b-9379-47fd-8fd7-f3a470ae059a" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>hat_St <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit1)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(hat_St, <span class="at">main=</span><span class="st">"추정된 계절성분"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-99-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 불규칙성분</p>
<div id="ff4c89bd-512e-43b0-be1e-5b2510e602b1" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>hat_It <span class="ot">&lt;-</span> export <span class="sc">-</span> hat_Tt <span class="sc">-</span> hat_St</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(hat_It); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-100-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 추정</p>
<div id="43923398-9ebe-4858-a814-dae199a99d48" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>pred_a <span class="ot">&lt;-</span> hat_Tt <span class="sc">+</span> hat_St</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(export, pred_a, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">ylab=</span><span class="st">"export"</span>, <span class="at">xlab=</span><span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-101-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="21bf6d57-ce07-4372-ad74-713dbcc6cfdb" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((export<span class="sc">-</span>pred_a)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
1374.40699758301
</div>
</div>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10">(2)</h2>
<p>추정된 불규칙성분의 분석을 통해 적용된 분해법이 적절했는지 논하여라.</p>
<div id="3dbf08bb-610d-466a-be4c-5ca1cbfa8d9d" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(hat_It) <span class="co">#H0 : mu=E(It)=0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  hat_It
t = 8.2505e-16, df = 85, p-value = 1
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.8621323  0.8621323
sample estimates:
   mean of x 
3.577489e-16 </code></pre>
</div>
</div>
<ul>
<li>평균이 0이다.</li>
</ul>
<div id="02181abe-ab31-412a-beeb-24d43d72bce5" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(hat_It)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-104-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="1ce9466e-eed7-4ea8-9404-1714f28604d6" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(hat_It<span class="sc">~</span> t),</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a> <span class="at">alternative =</span> <span class="st">'two.sided'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(hat_It ~ t)
DW = 0.79194, p-value = 1.672e-10
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
<p>양의 상관관계가 있어보인다.</p>
<div id="915a2a36-78a4-4904-9be9-fa11954a75fb" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">lm</span>(hat_It <span class="sc">~</span> t, <span class="at">data =</span> export))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    studentized Breusch-Pagan test

data:  lm(hat_It ~ t, data = export)
BP = 4.276, df = 1, p-value = 0.03865</code></pre>
</div>
</div>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11">(3)</h2>
<p>이동평균을 이용한 분해법에 의한 각 성분의 시계열 그림을 그려라</p>
<section id="이동평균분해법" class="level3">
<h3 class="anchored" data-anchor-id="이동평균분해법">이동평균분해법</h3>
<div id="2bb42047-f904-4b60-8cd1-7b1b8d6ff94d" class="cell" data-tags="[]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"export.txt"</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>export <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot.ts(export, lwd=2, main="TS plot for export data")</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(export)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ma</span>(export,<span class="dv">3</span>), <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ma</span>(export,<span class="dv">12</span>), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">'black'</span>, <span class="st">'blue'</span>, <span class="st">'red'</span>),</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">'원시계열'</span>, <span class="st">"CSMA(m=3)"</span>, <span class="st">"CSMA(m=12)"</span>),</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty=</span><span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-107-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="1d13eaeb-838a-4e69-a776-41e904541396" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>trend <span class="ot">=</span> <span class="fu">ma</span>(export, <span class="dv">12</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(trend, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-108-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="4c82ddb5-59e8-427b-94de-b436114a84b1" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>adj_trend <span class="ot">&lt;-</span>export <span class="sc">-</span> trend</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(adj_trend, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-109-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="ca03367a-578f-4c09-9d01-20f5ed5c33da" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> <span class="fu">tapply</span>(adj_trend, <span class="fu">cycle</span>(adj_trend), <span class="cf">function</span>(y) <span class="fu">mean</span>(y,<span class="at">na.rm=</span>T))</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>seasonal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>1</dt><dd>-8.57347222222222</dd><dt>2</dt><dd>-7.65451388888889</dd><dt>3</dt><dd>0.41888888888889</dd><dt>4</dt><dd>-1.69965277777778</dd><dt>5</dt><dd>-0.174375000000001</dd><dt>6</dt><dd>3.79819444444445</dd><dt>7</dt><dd>-0.0849999999999983</dd><dt>8</dt><dd>-1.4907738095238</dd><dt>9</dt><dd>1.85138888888889</dd><dt>10</dt><dd>0.540972222222225</dd><dt>11</dt><dd>3.35631944444444</dd><dt>12</dt><dd>9.97465277777778</dd></dl>
</div>
</div>
<div id="47dad804-7a73-467a-a5a4-035dafad7cae" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(adj_trend<span class="sc">~</span><span class="dv">0</span><span class="sc">+</span><span class="fu">as.factor</span>(<span class="fu">cycle</span>(adj_trend))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = adj_trend ~ 0 + as.factor(cycle(adj_trend)))

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3226 -1.4141  0.3492  1.8005  4.9008 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
as.factor(cycle(adj_trend))1   -8.5735     1.1268  -7.608 1.89e-10 ***
as.factor(cycle(adj_trend))2   -7.6545     1.1268  -6.793 4.90e-09 ***
as.factor(cycle(adj_trend))3    0.4189     1.1268   0.372  0.71135    
as.factor(cycle(adj_trend))4   -1.6997     1.1268  -1.508  0.13654    
as.factor(cycle(adj_trend))5   -0.1744     1.1268  -0.155  0.87752    
as.factor(cycle(adj_trend))6    3.7982     1.1268   3.371  0.00129 ** 
as.factor(cycle(adj_trend))7   -0.0850     1.0432  -0.081  0.93533    
as.factor(cycle(adj_trend))8   -1.4908     1.0432  -1.429  0.15803    
as.factor(cycle(adj_trend))9    1.8514     1.1268   1.643  0.10544    
as.factor(cycle(adj_trend))10   0.5410     1.1268   0.480  0.63286    
as.factor(cycle(adj_trend))11   3.3563     1.1268   2.979  0.00413 ** 
as.factor(cycle(adj_trend))12   9.9747     1.1268   8.852 1.33e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.76 on 62 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.7721,    Adjusted R-squared:  0.728 
F-statistic:  17.5 on 12 and 62 DF,  p-value: 1.335e-15</code></pre>
</div>
</div>
<div id="45ead62c-a104-43fb-8733-a55e805097e4" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(seasonal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.021885747354499
</div>
</div>
<div id="24755ff4-d862-4656-b985-c35e5a065351" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> seasonal <span class="sc">-</span> <span class="fu">mean</span>(seasonal) <span class="co">#평균을 0으로 수정</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>seasonal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>1</dt><dd>-8.59535796957672</dd><dt>2</dt><dd>-7.67639963624339</dd><dt>3</dt><dd>0.397003141534391</dd><dt>4</dt><dd>-1.72153852513228</dd><dt>5</dt><dd>-0.1962607473545</dd><dt>6</dt><dd>3.77630869708995</dd><dt>7</dt><dd>-0.106885747354497</dd><dt>8</dt><dd>-1.5126595568783</dd><dt>9</dt><dd>1.82950314153439</dd><dt>10</dt><dd>0.519086474867726</dd><dt>11</dt><dd>3.33443369708995</dd><dt>12</dt><dd>9.95276703042328</dd></dl>
</div>
</div>
<div id="e72f3eb4-c295-4451-906a-a1b67deb3233" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>St <span class="ot">=</span> <span class="fu">rep</span>(seasonal, <span class="dv">7</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(St)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-114-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="607ef78e-0098-4330-8ff5-f132f377c43f" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>irregular <span class="ot">&lt;-</span> export <span class="sc">-</span> trend <span class="sc">-</span> St</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(irregular)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message in `-.default`(export - trend, St):
“longer object length is not a multiple of shorter object length”</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-115-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="decompose-함수-이용" class="level3">
<h3 class="anchored" data-anchor-id="decompose-함수-이용">decompose 함수 이용</h3>
<div id="adf958c9-31d7-47d9-a070-08f91cf02350" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>dec_fit <span class="ot">&lt;-</span> <span class="fu">decompose</span>(export, <span class="st">'additive'</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dec_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>$x
       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec
1981 20.40 23.01 25.73 25.55 29.96 31.94 29.18 29.48 31.83 32.93 32.18 34.95
1982 28.98 29.32 36.53 36.73 40.29 42.41 42.24 34.79 44.41 40.42 44.24 52.45
1983 39.59 41.21 47.92 46.26 47.73 50.52 52.03 53.10 53.93 52.56 58.10 64.01
1984 44.01 43.37 53.30 47.84 49.50 54.27 52.33 52.68 54.75 53.04 56.55 62.14
1985 39.61 46.80 52.71 49.50 52.15 56.89 54.90 53.21 61.12 52.85 60.20 70.23
1986 46.39 48.65 57.26 58.39 61.46 66.60 55.40 57.63 56.80 66.37 66.77 76.97
1987 53.92 51.44 64.29 63.61 63.37 70.53 63.52 61.77 66.25 71.26 66.29 70.07
1988 53.34 59.68                                                            

$seasonal
            Jan        Feb        Mar        Apr        May        Jun
1981 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1982 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1983 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1984 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1985 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1986 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1987 -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
1988 -8.5953580 -7.6763996                                            
            Jul        Aug        Sep        Oct        Nov        Dec
1981 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1982 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1983 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1984 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1985 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1986 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1987 -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670
1988                                                                  

$trend
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
1981       NA       NA       NA       NA       NA       NA 29.28583 29.90625
1982 34.27833 35.04375 35.78917 36.62542 37.44000 38.67167 39.84292 40.78042
1983 44.72292 45.89375 47.05333 47.95583 49.03917 50.09833 50.76417 51.03833
1984 52.18083 52.17583 52.19250 52.24667 52.20208 52.05958 51.79833 51.75792
1985 52.53625 52.66542 52.95292 53.21042 53.35458 53.84375 54.46333 54.82292
1986 57.62583 57.83083 57.83500 58.21833 59.05542 59.61000 60.20458 60.63458
1987 62.59667 63.10750 63.67375 64.27125 64.45500 64.14750 63.83583 64.15500
1988       NA       NA                                                      
          Sep      Oct      Nov      Dec
1981 30.61917 31.53500 32.43125 33.29792
1982 41.75042 42.62208 43.32917 43.97708
1983 51.35250 51.64250 51.78208 52.01208
1984 51.87625 51.92083 52.10042 52.32000
1985 55.08958 55.64958 56.40792 57.20042
1986 61.04375 61.55417 61.85125 62.09458
1987       NA       NA       NA       NA
1988                                    

$random
              Jan          Feb          Mar          Apr          May
1981           NA           NA           NA           NA           NA
1982  3.297024636  1.952649636  0.343830192  1.826121858  3.046260747
1983  3.462441303  2.992649636  0.469663525  0.025705192 -1.112905919
1984  0.424524636 -1.129433697  0.710496858 -2.685128142 -2.505822586
1985 -4.330892030  1.810982970 -0.639919808 -1.988878142 -1.008322586
1986 -2.640475364 -1.504433697 -0.972003142  1.893205192  2.600844081
1987 -0.081308697 -3.991100364  0.219246858  1.060288525 -0.888739253
1988           NA           NA                                       
              Jun          Jul          Aug          Sep          Oct
1981           NA  0.001052414  1.086409557 -0.618669808  0.875913525
1982 -0.037975364  2.503969081 -4.477757110  0.830080192 -2.721169808
1983 -3.354642030  1.372719081  3.574326224  0.747996858  0.398413525
1984 -1.565892030  0.638552414  2.434742890  1.044246858  0.600080192
1985 -0.730058697  0.543552414 -0.100257110  4.200913525 -3.318669808
1986  3.213691303 -4.697697586 -1.491923776 -6.073253142  4.296746858
1987  2.606191303 -0.208947586 -0.872340443           NA           NA
1988                                                                 
              Nov          Dec
1981 -3.585683697 -8.300683697
1982 -2.423600364 -1.479850364
1983  2.983482970  2.045149636
1984  1.115149636 -0.132767030
1985  0.457649636  3.076816303
1986  1.584316303  4.922649636
1987           NA           NA
1988                          

$figure
 [1] -8.5953580 -7.6763996  0.3970031 -1.7215385 -0.1962607  3.7763087
 [7] -0.1068857 -1.5126596  1.8295031  0.5190865  3.3344337  9.9527670

$type
[1] "additive"

attr(,"class")
[1] "decomposed.ts"</code></pre>
</div>
</div>
<div id="dbbc47ab-e3af-4bc6-a93d-872182bb9bc2" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-117-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="b0603d04-5aca-432f-b393-7e4025b136b0" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>dec_fit2 <span class="ot">&lt;-</span> <span class="fu">decompose</span>(export, <span class="at">type =</span> <span class="st">"multiplicative"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec_fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-118-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="8c048e47-1dac-412b-b1df-e02e6a442ccd" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 가법모형 vs. 승법모형</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>pred_dec <span class="ot">&lt;-</span>dec_fit<span class="sc">$</span>trend<span class="sc">+</span>dec_fit<span class="sc">$</span>seasonal</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>pred_dec2 <span class="ot">&lt;-</span>dec_fit2<span class="sc">$</span>trend<span class="sc">*</span>dec_fit2<span class="sc">$</span>seasonal</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(pred_dec, pred_dec2, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">ylab=</span><span class="st">"food"</span>, <span class="at">xlab=</span><span class="st">"time"</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"가법모형"</span>, <span class="st">"승법모형"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-119-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="stl함수-이용" class="level3">
<h3 class="anchored" data-anchor-id="stl함수-이용">stl함수 이용</h3>
<div id="5bf6e48c-d921-47ab-afbe-2bf6bfdcfe5d" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>stl_fit1 <span class="ot">&lt;-</span> <span class="fu">stl</span>(export, <span class="at">s.window=</span><span class="dv">12</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>stl_fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code> Call:
 stl(x = export, s.window = 12)

Components
            seasonal    trend    remainder
Jan 1981 -8.03824134 26.81776  1.620485206
Feb 1981 -6.63002814 27.30969  2.330333480
Mar 1981 -0.13110622 27.80163 -1.940526967
Apr 1981 -2.16782904 28.29357 -0.575742678
May 1981 -0.02387280 28.83742  1.146455416
Jun 1981  3.12006392 29.38126 -0.561326978
Jul 1981  0.19259616 29.92511 -0.937704893
Aug 1981 -1.39615399 30.52457  0.351588714
Sep 1981  2.08889246 31.12402 -1.382914272
Oct 1981  0.78594126 31.72348  0.420580381
Nov 1981  3.14306515 32.53144 -3.494505630
Dec 1981  9.25329283 33.33940 -7.642695428
Jan 1982 -8.18853645 34.14736  3.021171726
Feb 1982 -6.74205914 35.02084  1.041217119
Mar 1982 -0.11359668 35.89432  0.749277352
Apr 1982 -2.14642909 36.76780  2.108632461
May 1982 -0.04765717 37.74653  2.591125433
Jun 1982  3.22089766 38.72527  0.463835494
Jul 1982  0.10549237 39.70400  2.430505678
Aug 1982 -1.41993463 40.61875 -4.408810621
Sep 1982  2.04045104 41.53349  0.836060406
Oct 1982  0.89651488 42.44823 -2.924746731
Nov 1982  3.20038177 43.30548 -2.265858677
Dec 1982  9.40282354 44.16272 -1.115545502
Jan 1983 -8.33955445 45.01997  2.909587433
Feb 1983 -6.85397510 46.00456  2.059414793
Mar 1983 -0.09513416 46.98915  1.025980554
Apr 1983 -2.12310901 47.97375  0.409362112
May 1983 -0.06855425 48.79308 -0.994521923
Jun 1983  3.32542520 49.61241 -2.417830650
Jul 1983  0.02288888 50.43173  1.575376391
Aug 1983 -1.43898388 50.82162  3.717366595
Sep 1983  1.99697212 51.21150  0.721528047
Oct 1983  1.01133498 51.60138 -0.052717360
Nov 1983  3.26122886 51.76546  3.073314934
Dec 1983  9.55393181 51.92953  2.526538154
Jan 1984 -8.63020919 52.09360  0.546605321
Feb 1984 -7.05228753 52.10779 -1.685505543
Mar 1984 -0.02362451 52.12198  1.201642230
Apr 1984 -2.05361665 52.13617 -2.242554829
May 1984 -0.12808589 52.06895 -2.440860110
Jun 1984  3.51447214 52.00172 -1.246192660
Jul 1984 -0.10905922 51.93450  0.504564171
Aug 1984 -1.46691120 51.96370  2.183207296
Sep 1984  1.91927553 51.99291  0.837811709
Oct 1984  1.27127927 52.02212 -0.253400890
Nov 1984  3.36913024 52.18801  0.992858614
Dec 1984  9.78170407 52.35390  0.004395256
Jan 1985 -8.94600253 52.51979 -3.963787671
Feb 1985 -7.27425538 52.75254  1.321719247
Mar 1985  0.02571289 52.98528 -0.300994963
Apr 1985 -2.00432115 53.21803 -1.713706857
May 1985 -0.20583899 53.58938 -1.233544814
Jun 1985  3.68735310 53.96074 -0.758092699
Jul 1985 -0.25511780 54.33210  0.823022411
Aug 1985 -1.50687743 54.83525 -0.118367709
Sep 1985  1.83161162 55.33839  3.949993500
Oct 1985  1.52356468 55.84154 -4.515109315
Nov 1985  3.47168119 56.34545  0.382869321
Dec 1985 10.00699125 56.84935  3.373654404
Jan 1986 -9.17170413 57.35326 -1.791555078
Feb 1986 -7.34995073 57.74972 -1.749772497
Mar 1986  0.01792431 58.14619 -0.904111549
Apr 1986 -2.00925233 58.54265  1.856601080
May 1986 -0.25578936 59.05157  2.664216221
Jun 1986  3.77379354 59.56050  3.265711445
Jul 1986 -0.35038247 60.06942 -4.319034430
Aug 1986 -1.52477949 60.53012 -1.375341107
Sep 1986  1.78721730 60.99082 -5.978041605
Oct 1986  1.64995719 61.45153  3.268514805
Nov 1986  3.51677071 61.86477  1.388457561
Dec 1986 10.11358765 62.27802  4.578396895
Jan 1987 -9.37155076 62.69126  0.600291580
Feb 1987 -7.40218241 63.09442 -4.252233068
Mar 1987  0.03120809 63.49757  0.761220146
Apr 1987 -1.99625213 63.90073  1.705524066
May 1987 -0.29094930 63.96479 -0.303838557
Jun 1987  3.87191769 64.02885  2.629234647
Jul 1987 -0.43707012 64.09291 -0.135837345
Aug 1987 -1.53661763 64.17446 -0.867840726
Sep 1987  1.74637383 64.25601  0.247616920
Oct 1987  1.77824626 64.33756  5.144193599
Nov 1987  3.56210251 64.39946 -1.671565286
Dec 1987 10.21967043 64.46137 -4.611035849
Jan 1988 -9.50110743 64.52327 -1.682160623
Feb 1988 -7.47541608 64.56485  2.590568880</code></pre>
</div>
</div>
<div id="53b531ba-0079-4648-b9b7-a134c1ffa68c" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stl_fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-123-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="168be030-8ef4-4ec3-9028-30764f1219ad" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>pred_stl <span class="ot">&lt;-</span> stl_fit1<span class="sc">$</span>time.series[,<span class="dv">1</span>]<span class="sc">+</span>stl_fit1<span class="sc">$</span>time.series[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12">(4)</h2>
<p>추정된 불규칙성분의 분석을 통해 적용된 분해법이 적절했는지 논하여라.</p>
<div id="c00bfbbc-cb03-4261-812c-7dea77b03951" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(irregular)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  irregular
t = 0.074013, df = 73, p-value = 0.9412
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.5674456  0.6112171
sample estimates:
 mean of x 
0.02188575 </code></pre>
</div>
</div>
<div id="10509492-eab4-48ad-bcd0-b80783549b49" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(irregular<span class="sc">~</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(irregular ~ 1)
DW = 1.9469, p-value = 0.4094
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<div id="758ed996-0f21-48c1-a5f3-c0ce90bc82a1" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(irregular<span class="sc">~</span>t))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(irregular ~ t)
DW = 1.9477, p-value = 0.3643
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<section id="추정" class="level3">
<h3 class="anchored" data-anchor-id="추정">추정</h3>
<div id="3458ce25-c436-45cf-941c-a7608234a547" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>fit_ <span class="ot">&lt;-</span> trend <span class="sc">+</span> St</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(export, fit_, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message in `+.default`(trend, St):
“longer object length is not a multiple of shorter object length”</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-129-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13">(5)</h2>
<p>각 분해법에 의한 결과를 1-시착 후 예측오차의 제곱합 (SSE) 기준하에서 2번의 결과와 예측 력을 비교하여라.</p>
<p><code>-</code> decompose</p>
<div id="b299d8bd-aaf9-45de-a5b8-2f48fad26b86" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((export<span class="sc">-</span>pred_dec)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) <span class="co">#SSE - 가법</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((export<span class="sc">-</span>pred_dec2)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) <span class="co">#SSE - 승법</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
472.381499188028
</div>
<div class="cell-output cell-output-display">
353.176184412717
</div>
</div>
<p><code>-</code> stl</p>
<div id="33ad4c07-fa00-4509-a521-c4bf126425f2" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((export<span class="sc">-</span>pred_stl)<span class="sc">^</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
506.70574427387
</div>
</div>
</section>
</section>
<section id="section-14" class="level1">
<h1>5</h1>
<p>(R 실습) ’usapass.txt’는 미국 월별 비행기 승객 수(단위 : 천 명)의 시계열자료이다. log 변환 후 아래의 분석을 수행하시오. ((2),(3),(4)번에 대하여 모형을 적합한 후 실제데이터와 각 모형에서 구해진 추정값을 비교하는 그림도 포함)</p>
<div id="4950c9df-9ae0-4fed-a547-54fe6ce67973" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>z5 <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"usapass.txt"</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z5)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>usapass <span class="ot">&lt;-</span> <span class="fu">ts</span>(z5, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(usapass, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"TS plot for export data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-132-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="92853f50-7691-4373-a5f5-c66005c549e5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>usapass_l <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(z5), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(usapass_l, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"TS plot for export data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-133-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="section-15" class="level2">
<h2 class="anchored" data-anchor-id="section-15">(1)</h2>
<p>왜 log 변환이 필요한지에 대해 간단히 설명하여라.</p>
<p>시도표를 확인하면 시간에 따라 분산이 커지는 것을 볼수 있다. 이는 모델의 결과가 잘못된 값이 나올 수 있다.</p>
</section>
<section id="section-16" class="level2">
<h2 class="anchored" data-anchor-id="section-16">(2)</h2>
<p>적절한 추세 모형을 적합시킨 후 잔차분석을 하여라.</p>
<div id="a7a0589b-7d4d-4b6b-a075-29749fbfeb42" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>z5_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(z5, <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cycle</span>(z5_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A Time Series: 12 × 12</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Jan</th>
<th data-quarto-table-cell-role="th" scope="col">Feb</th>
<th data-quarto-table-cell-role="th" scope="col">Mar</th>
<th data-quarto-table-cell-role="th" scope="col">Apr</th>
<th data-quarto-table-cell-role="th" scope="col">May</th>
<th data-quarto-table-cell-role="th" scope="col">Jun</th>
<th data-quarto-table-cell-role="th" scope="col">Jul</th>
<th data-quarto-table-cell-role="th" scope="col">Aug</th>
<th data-quarto-table-cell-role="th" scope="col">Sep</th>
<th data-quarto-table-cell-role="th" scope="col">Oct</th>
<th data-quarto-table-cell-role="th" scope="col">Nov</th>
<th data-quarto-table-cell-role="th" scope="col">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">5</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">6</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">7</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">8</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">9</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">10</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">11</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">12</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cb7a412b-0ba9-481c-91f0-6529037c1bb1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>seasonal_I <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cycle</span>(z5_ts))</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z5)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(z5)<span class="sc">~</span>t<span class="sc">+</span>seasonal_I)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="08a5feda-cc49-4d92-a836-e221202e25cd" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = log(z5) ~ t + seasonal_I)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.159814 -0.044426  0.000623  0.045572  0.151846 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.7246982  0.0198289 238.274  &lt; 2e-16 ***
t             0.0100999  0.0001252  80.666  &lt; 2e-16 ***
seasonal_I2  -0.0220859  0.0254094  -0.869  0.38633    
seasonal_I3   0.1095029  0.0254104   4.309 3.19e-05 ***
seasonal_I4   0.0768102  0.0254119   3.023  0.00302 ** 
seasonal_I5   0.0762636  0.0254141   3.001  0.00322 ** 
seasonal_I6   0.1990500  0.0254168   7.831 1.45e-12 ***
seasonal_I7   0.3049668  0.0254202  11.997  &lt; 2e-16 ***
seasonal_I8   0.2976260  0.0254242  11.706  &lt; 2e-16 ***
seasonal_I9   0.1461189  0.0254289   5.746 6.08e-08 ***
seasonal_I10  0.0110851  0.0254341   0.436  0.66367    
seasonal_I11 -0.1341418  0.0254399  -5.273 5.39e-07 ***
seasonal_I12 -0.0214153  0.0254464  -0.842  0.40156    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06224 on 131 degrees of freedom
Multiple R-squared:  0.982, Adjusted R-squared:  0.9803 
F-statistic: 594.1 on 12 and 131 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>적합된 모형: <span class="math inline">\(\hat Z_t = 4.72 + 0.01t - 0.022I_{t2} + \dots - 0.021 I_{t12}\)</span></li>
</ul>
<div id="7ec680be-6fe6-4d7a-b58d-56dae03d6977" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>tmp.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a> <span class="at">day =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">"1984-01-01"</span>),</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a> <span class="at">by=</span><span class="st">'1 month'</span>, <span class="at">length.out=</span><span class="fu">length</span>(z5)),</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a> <span class="at">z=</span>z5</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="75aa3f68-2774-41fd-971e-744dd9a87a5a" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)) </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z<span class="sc">~</span>day, tmp.data, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp.data<span class="sc">$</span>day, <span class="fu">exp</span>(<span class="fu">fitted</span>(m3)), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)    <span class="co"># m3에 exp함수 처리</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(z)<span class="sc">~</span>day, tmp.data, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp.data<span class="sc">$</span>day, <span class="fu">fitted</span>(m3), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-140-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="0124e070-955e-4213-a9bd-0a906a595f49" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>resid_m3 <span class="ot">&lt;-</span> <span class="fu">resid</span>(m3)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid_m3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-142-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="b44eeea7-81ac-4cef-80dc-c8a8b4f17e16" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(resid_m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  resid_m3
t = 1.4082e-16, df = 143, p-value = 1
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.009812747  0.009812747
sample estimates:
   mean of x 
6.990845e-19 </code></pre>
</div>
</div>
<div id="c11f8770-cb90-48de-8915-b8bc3ecebf72" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(resid_m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-144-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="1addb34d-b3c7-4b98-b194-26de9a7f5b58" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">bptest</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    studentized Breusch-Pagan test

data:  m3
BP = 5.9163, df = 12, p-value = 0.9202</code></pre>
</div>
</div>
<div id="2c0ff0df-1525-4013-a502-95a06372e5c2" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">dwtest</span>(m3, <span class="at">alternative=</span><span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  m3
DW = 0.40831, p-value &lt; 2.2e-16
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
<div id="e22e8248-dc5d-47c4-96d9-bcf28ab9614a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((<span class="fu">summary</span>(m3)<span class="sc">$</span>residual)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.507459833285849
</div>
</div>
</section>
<section id="section-17" class="level2">
<h2 class="anchored" data-anchor-id="section-17">(3)</h2>
<p>적절한 평활법을 적용한 후 잔차분석을 하여라.</p>
<section id="가법모형" class="level3">
<h3 class="anchored" data-anchor-id="가법모형">가법모형</h3>
<div id="b0010d2d-fff7-4bec-8113-4672cfd93ed4" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>fit_hw_l <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(usapass_l, <span class="at">seasonal=</span><span class="st">"additive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="756020e8-1f93-43eb-a1b1-a23f44d372c6" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>fit_hw_l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters exponential smoothing with trend and additive seasonal component.

Call:
HoltWinters(x = usapass_l, seasonal = "additive")

Smoothing parameters:
 alpha: 0.3447498
 beta : 0.003585913
 gamma: 0.879488

Coefficients:
            [,1]
a    6.165298459
b    0.008744433
s1  -0.073696849
s2  -0.142822821
s3  -0.039964334
s4   0.015968620
s5   0.033673237
s6   0.157016140
s7   0.300626468
s8   0.285698068
s9   0.098491289
s10 -0.021898771
s11 -0.190036243
s12 -0.096734648</code></pre>
</div>
</div>
<div id="4f0db86f-0a94-48ae-a959-c84fe4a9cd92" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)) </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z<span class="sc">~</span>day, tmp.data, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp.data<span class="sc">$</span>day, <span class="fu">exp</span>(<span class="fu">fitted</span>(m3)), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)    <span class="co"># m3에 exp함수 처리</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(z)<span class="sc">~</span>day, tmp.data, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp.data<span class="sc">$</span>day, <span class="fu">fitted</span>(m3), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-151-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="6f88d0ac-4076-4c93-b96b-c524a7a6d7c0" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="ot">=</span> <span class="fu">hw</span>(usapass_l,</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a> <span class="at">alpha =</span> fit_hw_l<span class="sc">$</span>alpha,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a> <span class="at">beta =</span> fit_hw_l<span class="sc">$</span>beta,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a> <span class="at">gamma =</span> fit_hw_l<span class="sc">$</span>gamma,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a> <span class="at">seasonal=</span><span class="st">"additive"</span>,</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a> <span class="at">initial=</span><span class="st">"simple"</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a> <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>fit6<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters' additive method 

Call:
 hw(y = usapass_l, h = 12, seasonal = "additive", initial = "simple",  

 Call:
     alpha = fit_hw_l$alpha, beta = fit_hw_l$beta, gamma = fit_hw_l$gamma) 

  Smoothing parameters:
    alpha = 0.3447 
    beta  = 0.0036 
    gamma = 0.8795 

  Initial states:
    l = 4.8362 
    b = 0.0079 
    s = -0.0655 -0.1918 -0.0571 0.0765 0.161 0.161
           0.0691 -0.0404 0.0236 0.0466 -0.0655 -0.1177

  sigma:  0.0425</code></pre>
</div>
</div>
<p><code>-</code> 원데이터와 비교그림 넣어주기 위해서 exp취해줌</p>
<div id="bceccfba-4038-444c-a1fc-8ce867dfb610" class="cell" data-execution_count="262">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(usapass)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">exp</span>(fit6<span class="sc">$</span>fitted), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-153-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="18fa77d7-9706-410c-88ed-78f8d61ebd14" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fit6<span class="sc">$</span>residual, <span class="at">ylab=</span><span class="st">"residual"</span>,</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a> <span class="at">main=</span><span class="st">"가법모형의 잔차 그림"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-154-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="0070b10e-9b45-4431-88e8-823cfbe71d55" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fit6<span class="sc">$</span>residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  fit6$residual
t = 0.72402, df = 143, p-value = 0.4702
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.004441394  0.009575433
sample estimates:
  mean of x 
0.002567019 </code></pre>
</div>
</div>
<div id="c95a92fd-56d2-4140-ba3c-fdde99c6eaf3" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(fit6<span class="sc">$</span>residual<span class="sc">~</span><span class="dv">1</span>), <span class="at">alternative =</span> <span class="st">'two.sided'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(fit6$residual ~ 1)
DW = 1.5421, p-value = 0.005659
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
</section>
<section id="승법모형원데이터로-진행해봄" class="level3">
<h3 class="anchored" data-anchor-id="승법모형원데이터로-진행해봄">승법모형(원데이터로 진행해봄)</h3>
<div id="b374d1f4-4863-41e9-8f21-906c51a24049" class="cell" data-execution_count="264">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>fit_hw_m <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(usapass, <span class="at">seasonal=</span><span class="st">"multiplicative"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3e3fba3e-5ce2-4ce2-a87b-47848aa43936" class="cell" data-execution_count="267">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_hw_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-158-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="fca11dbc-55d9-4284-8563-eee3b38bd3b1" class="cell" data-execution_count="265">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="ot">=</span> <span class="fu">hw</span>(usapass,</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a> <span class="at">alpha =</span> fit_hw_m<span class="sc">$</span>alpha,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a> <span class="at">beta =</span> fit_hw_m<span class="sc">$</span>beta,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a> <span class="at">gamma =</span> fit_hw_m<span class="sc">$</span>gamma,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a> <span class="at">seasonal=</span><span class="st">"multiplicative"</span>,</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a> <span class="at">initial=</span><span class="st">"simple"</span>,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a> <span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>fit7<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters' multiplicative method 

Call:
 hw(y = usapass, h = 12, seasonal = "multiplicative", initial = "simple",  

 Call:
     alpha = fit_hw_m$alpha, beta = fit_hw_m$beta, gamma = fit_hw_m$gamma) 

  Smoothing parameters:
    alpha = 0.3205 
    beta  = 0.0239 
    gamma = 1 

  Initial states:
    l = 126.6667 
    b = 1.0833 
    s = 0.9316 0.8211 0.9395 1.0737 1.1684 1.1684
           1.0658 0.9553 1.0184 1.0421 0.9316 0.8842

  sigma:  0.0465</code></pre>
</div>
</div>
<div id="e14d2835-fd6e-4c04-9edc-4f26b9f5c3b4" class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fit7<span class="sc">$</span>residual, <span class="at">ylab=</span><span class="st">"residual"</span>,</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a> <span class="at">main=</span><span class="st">"승법모형의 잔차 그림"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-160-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="71d55006-143e-40de-b617-9cbc06eca23a" class="cell" data-execution_count="269">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fit7<span class="sc">$</span>residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  fit7$residual
t = 1.0873, df = 143, p-value = 0.2787
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.9675137  3.3332414
sample estimates:
mean of x 
 1.182864 </code></pre>
</div>
</div>
<div id="47bd79cb-b4fb-4ca9-b20e-3dbae6f58415" class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(fit7<span class="sc">$</span>residual<span class="sc">~</span><span class="dv">1</span>), <span class="at">alternative =</span> <span class="st">'two.sided'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(fit7$residual ~ 1)
DW = 1.4311, p-value = 0.0005873
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
</section>
</section>
<section id="section-18" class="level2">
<h2 class="anchored" data-anchor-id="section-18">(4)</h2>
<p>적절한 분해법에 의해 각 성분을 분해해여 시계열 그림을 그려라.</p>
<section id="decopose분해법" class="level3">
<h3 class="anchored" data-anchor-id="decopose분해법">decopose분해법</h3>
<div id="b5fa1e3c-2d85-4152-9bd9-c03ee6825604" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>dec_f_a_l <span class="ot">&lt;-</span> <span class="fu">decompose</span>(usapass_l, <span class="st">'additive'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1b381586-3a86-4e44-979a-cfe07f769feb" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec_f_a_l) <span class="co"># 로그변환 후 분해법</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-164-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="541e70b6-620c-4b43-8a0d-5ca830d1e42c" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## 승법모형 비교용</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dec_f_m &lt;- decompose(usapass, type = "multiplicative")</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(dec_f_m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bff2db42-60cb-4b24-b482-83ca7f68a790" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>pred_dec_ <span class="ot">&lt;-</span> dec_f_a_l<span class="sc">$</span>trend <span class="sc">+</span> dec_f_a_l<span class="sc">$</span>seasonal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d9caad1a-d649-4d6c-8c16-32cc5f54d4e1" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 가법모형 vs. 승법모형</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>pred_dec_ <span class="ot">&lt;-</span>dec_f_a_l<span class="sc">$</span>trend<span class="sc">+</span>dec_f_a_l<span class="sc">$</span>seasonal</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>pred_dec2_ <span class="ot">&lt;-</span>dec_f_m<span class="sc">$</span>trend<span class="sc">*</span>dec_f_m<span class="sc">$</span>seasonal</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">exp</span>(pred_dec_), pred_dec2_, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">ylab=</span><span class="st">"usapass"</span>, <span class="at">xlab=</span><span class="st">"time"</span>)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"가법모형"</span>, <span class="st">"승법모형"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-167-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="f5bb2ace-4fde-4b01-a01e-e198dc325ca8" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((usapass_l<span class="sc">-</span>pred_dec_)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.161507492507272
</div>
</div>
</section>
<section id="stl비교용" class="level3">
<h3 class="anchored" data-anchor-id="stl비교용">stl(비교용)</h3>
<div id="e6590917-f873-485e-beee-6887897dab3e" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>stl_fit11 <span class="ot">&lt;-</span> <span class="fu">stl</span>(usapass_l, <span class="at">s.window=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="95127b34-e2d3-4dbf-86ae-e5ce8408302e" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stl_fit11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-170-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="7e1305ff-1e54-41a1-a58b-6f5d9dc2fdf9" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="do">## stl vs. decompose</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>pred_stl <span class="ot">&lt;-</span> stl_fit11<span class="sc">$</span>time.series[,<span class="dv">1</span>]<span class="sc">+</span>stl_fit11<span class="sc">$</span>time.series[,<span class="dv">2</span>]</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(pred_stl, pred_dec_, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">ylab=</span><span class="st">"food"</span>, <span class="at">xlab=</span><span class="st">"time"</span>,</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"stl vs. decomse"</span>)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"stl"</span>, <span class="st">"decomse"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-171-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="dd4b976f-d02c-42e4-b96e-8d73ad367fe3" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SSE : 1-시차 후 예측 오차 제곱합</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((usapass_l<span class="sc">-</span>pred_stl)<span class="sc">^</span><span class="dv">2</span>) <span class="co">#144</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((usapass_l<span class="sc">-</span>pred_dec_)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) <span class="co">#144-12=132</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.101745211385709
</div>
<div class="cell-output cell-output-display">
0.161507492507272
</div>
</div>
</section>
<section id="추세를-이용한-분해법가법" class="level3">
<h3 class="anchored" data-anchor-id="추세를-이용한-분해법가법">추세를 이용한 분해법(가법)</h3>
<div id="4c07ca94-19da-455f-a851-645eb58845a7" class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>fit45 <span class="ot">&lt;-</span> <span class="fu">lm</span>(usapass_l <span class="sc">~</span> t)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit45)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = usapass_l ~ t)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30875 -0.10481 -0.01736  0.09677  0.36311 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 4.8131072  0.0237011  203.07   &lt;2e-16 ***
t           0.0100802  0.0002836   35.54   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1415 on 142 degrees of freedom
Multiple R-squared:  0.899, Adjusted R-squared:  0.8982 
F-statistic:  1263 on 1 and 142 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(\hat T_t = 4.8131072 + 0.0100802t\)</span></li>
</ul>
<div id="cf1b4de8-b983-4601-b2ba-7160b99c1540" class="cell" data-execution_count="275">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>hat_Tt_l <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit45)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(usapass_l, hat_Tt_l,</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"usapass_l"</span>, <span class="at">xlab=</span><span class="st">"time"</span>,</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"log변환한 시계열과 분해법에 의한 추세성분"</span>)</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">"ln(z)"</span>, <span class="st">"추세성분"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-174-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="05210a1f-1ccd-42c2-8995-be83e757a32d" class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 원시계열에서 추세성분 조정</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>adjtrend_l <span class="ot">=</span> usapass_l<span class="sc">-</span>hat_Tt_l</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(adjtrend_l, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-175-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="10e17c40-6b45-4b25-a731-d00817af9cd9" class="cell" data-execution_count="279">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 지시함수를 이용한 계절성분 추정</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">cycle</span>(adjtrend_l)) <span class="co">#범주형 변수로 변환</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>fit456 <span class="ot">&lt;-</span> <span class="fu">lm</span>(adjtrend_l <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span>y)</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit456)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = adjtrend_l ~ 0 + y)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.158515 -0.044012  0.001096  0.045041  0.152437 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
y1  -0.08709    0.01790  -4.865 3.20e-06 ***
y2  -0.10916    0.01790  -6.098 1.11e-08 ***
y3   0.02245    0.01790   1.254  0.21195    
y4  -0.01022    0.01790  -0.571  0.56899    
y5  -0.01075    0.01790  -0.600  0.54926    
y6   0.11206    0.01790   6.260 5.00e-09 ***
y7   0.21799    0.01790  12.178  &lt; 2e-16 ***
y8   0.21067    0.01790  11.769  &lt; 2e-16 ***
y9   0.05919    0.01790   3.306  0.00122 ** 
y10 -0.07583    0.01790  -4.236 4.24e-05 ***
y11 -0.22103    0.01790 -12.348  &lt; 2e-16 ***
y12 -0.10829    0.01790  -6.049 1.40e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06201 on 132 degrees of freedom
Multiple R-squared:  0.8214,    Adjusted R-squared:  0.8052 
F-statistic: 50.59 on 12 and 132 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><span class="math inline">\(\hat S_t = -0.08709I_1 + \dots - 0.10829I_{12}\)</span></p>
<div id="bb1130fc-1a80-4cf9-88ac-f5497a0be2da" class="cell" data-execution_count="280">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>hat_St_l <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit456)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(hat_St_l, <span class="at">main=</span><span class="st">"추정된 계절성분"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-177-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="7a6eced7-8044-48c4-8b82-0d23032325c9" class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>hat_It_l <span class="ot">&lt;-</span> usapass_l <span class="sc">-</span> hat_Tt_l <span class="sc">-</span> hat_St_l</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(hat_It_l); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-178-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 추정</p>
<div id="39154dbf-11ef-4066-868f-0632ce30e467" class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>pred_a_l <span class="ot">&lt;-</span> hat_Tt_l <span class="sc">+</span> hat_St_l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f3001379-30fc-40c6-bc60-3b785c4f9361" class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(usapass, <span class="fu">exp</span>(pred_a_l), <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">ylab=</span><span class="st">"usapass"</span>, <span class="at">xlab=</span><span class="st">"time"</span>,</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"시계열과 분해법에 의한 추정값"</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"Z"</span>, <span class="st">"추정값"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-180-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="추세를-이용한-분해법승법" class="level3">
<h3 class="anchored" data-anchor-id="추세를-이용한-분해법승법">추세를 이용한 분해법(승법)</h3>
<div id="42b1139c-4543-4eed-925b-b9d2a3c6084a" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 추세성분 추정</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(usapass <span class="sc">~</span> t ) </span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = usapass ~ t)

Residuals:
    Min      1Q  Median      3Q     Max 
-95.238 -31.381  -6.677  24.113 163.347 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 87.41968    7.91971   11.04   &lt;2e-16 ***
t            2.67074    0.09477   28.18   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 47.27 on 142 degrees of freedom
Multiple R-squared:  0.8483,    Adjusted R-squared:  0.8473 
F-statistic: 794.3 on 1 and 142 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(\hat T_t = 87.41968 + 2.67074t\)</span></li>
</ul>
<div id="c5741811-ba09-4e15-bef9-15f64ad06e8e" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(usapass, <span class="fu">fitted</span>(fit5) , <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">ylab=</span><span class="st">"usapass"</span>, <span class="at">xlab=</span><span class="st">"time"</span>,</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a> <span class="at">main=</span><span class="st">"원시계열과 분해법에 의한 추세성분"</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"원시계열"</span>, <span class="st">"추세성분"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-187-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="1b90d8ff-0f6f-43de-983e-4c8d35004ea2" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>fit5_ <span class="ot">&lt;-</span> <span class="fu">lm</span>(usapass <span class="sc">~</span> t <span class="sc">+</span> <span class="fu">I</span>(t<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit5_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = usapass ~ t + I(t^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-101.286  -27.201   -7.821   20.791  145.107 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.113e+02  1.172e+01   9.494  &lt; 2e-16 ***
t           1.689e+00  3.733e-01   4.525 1.27e-05 ***
I(t^2)      6.770e-03  2.494e-03   2.715  0.00746 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 46.25 on 141 degrees of freedom
Multiple R-squared:  0.8559,    Adjusted R-squared:  0.8538 
F-statistic: 418.6 on 2 and 141 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="d4846bf5-ecec-4454-9542-1241d00eeae4" class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(usapass, <span class="fu">fitted</span>(fit5), <span class="fu">fitted</span>(fit5_), <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">ylab=</span><span class="st">"usapass"</span>,</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a> <span class="at">main=</span><span class="st">"원시계열과 분해법에 의한 추세성분"</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">"원시계열"</span>, <span class="st">"추세성분"</span>, <span class="st">"2차 추세성분"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-189-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="fa75b648-b362-45c0-985c-aaf0e276c32c" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 원시계열에서 추세성분 조정</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>trend_5 <span class="ot">=</span> <span class="fu">fitted</span>(fit5)  <span class="co"># 1차 추세모형</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>adjtrend_5 <span class="ot">=</span> usapass<span class="sc">/</span>trend_5</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(adjtrend_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-190-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="9d36d431-d4ba-4873-b748-b0d01f645b59" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 원시계열에서 2차 추세성분 조정</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>trend_5_ <span class="ot">=</span> <span class="fu">fitted</span>(fit5_)  <span class="co"># 2차 추세모형</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>adjtrend_5_ <span class="ot">=</span> usapass<span class="sc">/</span>trend_5_</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(adjtrend_5_)</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-191-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="c2929da7-353a-4e37-b086-38ad95910729" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 지시함수를 이용한 계절성분 추정</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">cycle</span>(adjtrend_5_)) </span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>fit55 <span class="ot">&lt;-</span> <span class="fu">lm</span>(adjtrend_5_ <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span>y)</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit55)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = adjtrend_5_ ~ 0 + y)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.115502 -0.040795  0.001315  0.026514  0.177535 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
y1   0.91079    0.01538   59.22   &lt;2e-16 ***
y2   0.89219    0.01538   58.01   &lt;2e-16 ***
y3   1.01655    0.01538   66.10   &lt;2e-16 ***
y4   0.98286    0.01538   63.91   &lt;2e-16 ***
y5   0.98163    0.01538   63.83   &lt;2e-16 ***
y6   1.10939    0.01538   72.13   &lt;2e-16 ***
y7   1.23340    0.01538   80.20   &lt;2e-16 ***
y8   1.22448    0.01538   79.62   &lt;2e-16 ***
y9   1.05099    0.01538   68.34   &lt;2e-16 ***
y10  0.91823    0.01538   59.70   &lt;2e-16 ***
y11  0.79424    0.01538   51.64   &lt;2e-16 ***
y12  0.88904    0.01538   57.81   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05328 on 132 degrees of freedom
Multiple R-squared:  0.9974,    Adjusted R-squared:  0.9972 
F-statistic:  4301 on 12 and 132 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><span class="math inline">\(\hat S_t = 0.91079I_1 + \dots + 0.88904I_{12}\)</span></p>
<div id="ef18fa55-7289-4ca1-9814-14d3b67d2e19" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit55)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(seasonal, <span class="at">main=</span><span class="st">"추정된 계절성분"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-193-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="1c6d5284-ba59-4f19-8442-9abb99d2c08a" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(adjtrend_5_, seasonal, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">main=</span><span class="st">"추세조정된 시계열"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-194-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="ea747a4b-94d6-4f5a-92c5-cb0a1708bd1a" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>irregular5 <span class="ot">&lt;-</span> usapass<span class="sc">/</span>trend_5<span class="sc">/</span>seasonal</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(irregular5); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-195-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="9ca025fa-4ef6-498b-b22d-c4b10a09fa67" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(irregular5, <span class="at">mu=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  irregular5
t = 1.2411, df = 143, p-value = 0.2166
alternative hypothesis: true mean is not equal to 1
95 percent confidence interval:
 0.994507 1.024030
sample estimates:
mean of x 
 1.009268 </code></pre>
</div>
</div>
<div id="96f6ec09-5b44-4af9-9ff4-e032161a2964" class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(irregular5<span class="sc">~</span> <span class="dv">1</span>), <span class="at">alternative =</span> <span class="st">'two.sided'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(irregular5 ~ 1)
DW = 0.19413, p-value &lt; 2.2e-16
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
<div id="fd60a2a8-af28-48e6-b149-76304ae8dcba" class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>pred_m5 <span class="ot">&lt;-</span> trend_5 <span class="sc">*</span> seasonal</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(usapass, pred_m5, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">ylab=</span><span class="st">"food"</span>, <span class="at">xlab=</span><span class="st">"time"</span>,</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a> <span class="at">main=</span><span class="st">"원시계열과 분해법에 의한 추정값"</span>)</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"원시계열"</span>, <span class="st">"추정값"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="[TS] HW02_files/figure-html/cell-198-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="틀림-ㅠㅠ" class="level2">
<h2 class="anchored" data-anchor-id="틀림-ㅠㅠ">(5) 틀림 ㅠㅠ</h2>
<p>각 분석방법에 의한 결과를 1-시착 후 예측오차의 제곱합 (SSE) 기준하에서 비교하여라.</p>
<p><code>-</code> 추세모형</p>
<div id="40583790-38f3-4b91-b388-1bfeed2d8503" class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((m3<span class="sc">$</span>residuals)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.507459833285849
</div>
</div>
<p><code>-</code> 평활법</p>
<div id="e72e9c1f-795b-408f-ad89-ef6fd962ad4c" class="cell" data-execution_count="285">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(fit_hw_l<span class="sc">$</span>SSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
1.24913252727246
</div>
</div>
<p><code>-</code> decompose</p>
<div id="123ae48a-b924-4f79-bc52-cacb8df6dfaa" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((usapass_l<span class="sc">-</span>pred_dec_)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) <span class="co">#SSE - 가법</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.161507492507272
</div>
</div>
<p><code>-</code> stl</p>
<div id="ae7fc000-b86b-47fc-922e-088c7297bb7f" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((usapass_l<span class="sc">-</span>pred_stl)<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.101745211385709
</div>
</div>
<p><code>-</code> 추세를 이용한 분해법(가법)</p>
<div id="5bb67956-b366-4807-ae89-516d8e315400" class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((usapass_l<span class="sc">-</span>pred_a_l)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.507555612028427
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>